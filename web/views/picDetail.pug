extends layout

block content
  .page-header
    h3=title

  .container
    .row
      .col-lg-12

        form.form-horizontal(method='POST')
          .row
            .col-lg-12
              fieldset
                if pic.id
                  input(type='hidden', name='id' value=pic.id)
                .form-group
                  label(for='name') Name:
                  input.form-control(type='text' name='name' placeholder='Name' value=pic.name)
                .form-group
                  label(for='hashtags') Hashtags
                  input#hashtaglist(type='hidden', name='hashtaglist' value=hashtaglist)
                  input.form-control#hashtags(type="text" name='hashtags' value="red,green,blue")
          .row
            .col-lg-12
              br
              div.pull-right
                a#return(href='/backoffice/pics/').btn.btn-primary
                  i.fa.fa-arrow-left
                  | Return
                if pic.id
                  button.btn.btn-danger(type='button' onclick='del();')
                    i.fa.fa-trash-o
                    | Delete
                button.btn.btn-success(type='submit' formmethod='POST' formaction='/backoffice/pics/')
                  i.fa.fa-save
                  | Save
  script.

    $(document).ready(function() {
      $('#hashtags').tokenfield({
        autocomplete: {
          source: JSON.parse($('[name="hashtaglist"]').val()),
          delay: 100
        },
        showAutocompleteOnFocus: true
      });
    });

    var del = function(){
      $.ajax({
        type: "DELETE",
        url: window.location.href,
        error: function(err) {
          alert(err);
          console.log(err);
        },
        success: function(resp) {
          if (resp.result) {
            var href = $('#return').attr('href');
            window.location.href = href;
          }
        }
      });
    };
